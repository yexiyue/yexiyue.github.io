---
title: dialoguer-macro 0.3
date: 2024-02-26
cover: /homeImage/1.jpg
tags:
  - rust
  - è¿‡ç¨‹å®
categories:
  - å­¦ä¹ ç¬”è®°
sticky: true
---

::: tip ä»‹ç»
dialoguer-macro 0.3
:::

<!-- more -->

ğŸš€ **å¯¹è¯å®æ¡†æ¶ dialoguer-macro 0.3 ç‰ˆæœ¬éœ‡æ’¼å‘å¸ƒï¼šå¼•é¢†å‘½ä»¤è¡Œäº¤äº’è®¾è®¡æ–°ç¯‡ç« **

ğŸ‰ å°Šæ•¬çš„å¼€å‘è€…ä»¬ï¼Œä»Šå¤©æˆ‘æ€€ç€æ— æ¯”æ¿€åŠ¨çš„å¿ƒæƒ…å‘å¤§å®¶éš†é‡æ¨è `dialoguer-macro` åº“çš„æœ€æ–°åŠ›ä½œâ€”â€”0.3 ç‰ˆæœ¬ï¼è¿™ä¸€ç‰ˆæœ¬çš„é‡å¤§æ›´æ–°å°†å½»åº•é¢ è¦†æ‚¨å¯¹å‘½ä»¤è¡Œç”¨æˆ·äº¤äº’è®¾è®¡çš„ä¼ ç»Ÿè®¤çŸ¥ã€‚æˆ‘ä»¬å·²åœ¨æ–°ç‰ˆæœ¬ä¸­å€¾æƒ…å¼•å…¥äº†å¯¹æšä¸¾ç±»å‹å’ŒåµŒå¥—ç»“æ„çš„å¼ºå¤§æ”¯æŒï¼Œè®©æ‚¨è½»æ¾æ„å»ºå‡ºå±‚æ¬¡åˆ†æ˜ã€ç»“æ„ä¼˜é›…çš„å‘½ä»¤è¡Œäº¤äº’ç•Œé¢ï¼

ğŸ“š **æ–‡æ¡£æ•™ç¨‹ç›´é€šè½¦**ï¼š[https://yexiyue.github.io/dialogue-macro/](https://yexiyue.github.io/dialogue-macro/)

ğŸ¯ **å®æˆ˜æ¼”ç¤ºå¼€ç¯‡**ï¼š

åœ¨è¿™ç¯‡åšå®¢ä¸­ï¼Œæˆ‘ä»¬å°†é€šè¿‡ä¸€ä¸ªé²œæ´»å…·ä½“çš„å®ä¾‹æ¥æ­ç¤ºå¦‚ä½•è¿ç”¨ `dialoguer-macro` 0.3 ä¸­ `SubAsker` å±æ€§åŠå…¶å…³è”çš„ `Asker`ã€`Build` å’Œ `EnumAsker` ç‰¹è´¨ï¼Œæ‰“é€ ä¸€å¥—é«˜æ•ˆä¸”æ˜“ç”¨çš„å‘½ä»¤è¡Œä¿¡æ¯æ”¶é›†æµç¨‹ã€‚

**è®©æˆ‘ä»¬ä¸€ç¹ä¸ºå¿«ï¼**

**é¦–å…ˆ**ï¼Œå®šä¹‰äº†ä¸€ä¸ªåä¸º `UserInput` çš„ç»“æ„ä½“ï¼Œå¹¶åˆ©ç”¨ `#[derive(Asker)]` å’Œ `#[asker(theme = "...")]` å®å¯¹å…¶è¿›è¡Œè£…é¥°ï¼Œä»è€Œå®ç°æ—¢ç¾è§‚åˆåŠŸèƒ½ä¸°å¯Œçš„å‘½ä»¤è¡Œè¾“å…¥ç•Œé¢ã€‚

å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œç»“æ„ä½“ä¸­çš„ `detailed_info` å’Œ `identity` å­—æ®µéƒ½åº”ç”¨äº† `#[asker(SubAsker)]` æ ‡è®°ï¼Œè¿™è¡¨ç¤ºå®ƒä»¬å°†ä»¥å­è¯¢é—®å™¨ï¼ˆSubAskerï¼‰çš„è§’è‰²é€å±‚æ·±å…¥åœ°è·å–ç”¨æˆ·è¾“å…¥æ•°æ®ï¼š

```rust
use dialogue_macro::{Asker, Build, EnumAsker};

#[derive(Debug, Asker)]
#[asker(theme = "dialogue_macro::ColorfulTheme")]
struct UserInput {
    // åŸºç¡€ä¿¡æ¯å­—æ®µ
    username: String,
    educational_institution: String,

    // ä½¿ç”¨ SubAsker æ”¶é›†è¯¦ç»†ç”¨æˆ·ä¿¡æ¯
    #[asker(SubAsker)]
    detailed_info: DetailedUserInfo,

    // ä½¿ç”¨ SubAsker è¿›è¡Œèº«ä»½é€‰æ‹©
    #[asker(SubAsker)]
    identity: EnumSelection,
}
```

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ç²¾å¿ƒè®¾è®¡äº†ä¸¤ä¸ªç”¨äºåµŒå¥—è¯¢é—®çš„æ•°æ®ç»“æ„ï¼š

**DetailedUserInfo ç»“æ„ä½“**ï¼Œå°è£…äº†ç”¨æˆ·çš„ç”µå­é‚®ä»¶åœ°å€å’Œå¹´é¾„å±æ€§ã€‚ä¸ºäº†é€‚åº” `SubAsker` çš„å·¥ä½œæ–¹å¼ï¼Œæ­¤ç»“æ„ä½“ä¸ä»…å®ç°äº† `Debug`ã€`Clone` å’Œ `Asker` ç‰¹æ€§ï¼Œè¿˜é¢å¤–å®ç°äº† `Build` ç‰¹è´¨ï¼Œå¹¶åœ¨ `impl Build for DetailedUserInfo` ä¸­å®šä¹‰äº† `.build()` æ–¹æ³•ï¼Œä»¥ä¾¿æŒ‰åºä»ç”¨æˆ·é‚£é‡Œè·å–é‚®ç®±åœ°å€å’Œå¹´é¾„ï¼š

```rust
#[derive(Debug, Clone, Asker)]
struct DetailedUserInfo {
    email_address: String,
    age: u8,
}

impl Build for DetailedUserInfo {
    fn build() -> Self {
        Self::asker()
            .email_address("è¯·æä¾›æ‚¨çš„é‚®ç®±åœ°å€")
            .age("è¯·è¾“å…¥æ‚¨çš„å¹´é¾„")
            .finish()
    }
}
```

**EnumSelection æšä¸¾**ï¼ŒåŒ…å«äº† Teacherã€Student å’Œ Leader ä¸‰ä¸ªé€‰é¡¹ã€‚è¯¥æšä¸¾é™¤äº†å®ç°äº† `Debug` å’Œ `Clone` ç‰¹è´¨å¤–ï¼Œè¿˜æ´¾ç”Ÿäº† `EnumAsker` ç‰¹è´¨ï¼Œè¿™æ„å‘³ç€å®ƒèƒ½å¤Ÿä»¥æ¸…æ™°ç›´è§‚çš„æ–¹å¼å‘ˆç°åœ¨ç”¨æˆ·é¢å‰ä¾›å…¶é€‰æ‹©ï¼š

```rust
#[derive(Debug, EnumAsker, Clone)]
#[asker(prompt="è¯·é€‰æ‹©æ‚¨çš„èº«ä»½", default="Student")]
enum EnumSelection {
    Teacher,
    Student,
    Leader,
}
```

æœ€åï¼Œåœ¨ä¸»å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºå¹¶å®ä¾‹åŒ–äº† `UserInput` å¯¹è±¡ï¼Œå¹¶æŒ‰ç…§é€»è¾‘é¡ºåºä¾æ¬¡è°ƒç”¨å„ä¸ªå­—æ®µå¯¹åº”çš„è¯¢é—®æ–¹æ³•ï¼š

```rust
fn main() {
    let collected_user_input = UserInput::asker()
        .username("è¯·è¾“å…¥ç”¨æˆ·å")
        .educational_institution("è¯·è¾“å…¥æ‚¨çš„å­¦æ ¡åç§°")

        // è°ƒç”¨ SubAsker æ”¶é›†è¯¦ç»†çš„ç”¨æˆ·ä¿¡æ¯
        .detailed_info()

        // è°ƒç”¨å¦ä¸€ä¸ª SubAsker è®©ç”¨æˆ·ä»æšä¸¾é€‰é¡¹ä¸­åšå‡ºé€‰æ‹©
        .identity()

        // æ”¶é›†æ‰€æœ‰ç”¨æˆ·è¾“å…¥å¹¶ç»“æŸè¯¢é—®è¿‡ç¨‹
        .finish();

    println!("{:?}", collected_user_input);
}
```

å½“è¿è¡Œç¨‹åºæ—¶ï¼Œç”¨æˆ·ä¼šæŒ‰ç…§é¢„è®¾çš„å±‚çº§é¡ºåºé€ä¸€å›ç­”é—®é¢˜ï¼Œä½“éªŒåˆ°ä¸€ç§æ—¢å¤æ‚åˆæœ‰æ¡ä¸ç´Šçš„å‘½ä»¤è¡Œäº¤äº’ä¹‹æ—…ï¼

é€šè¿‡ä¸Šè¿°å®ä¾‹ä»£ç ï¼Œæˆ‘ä»¬å±•ç¤ºäº†å¦‚ä½•è¿ç”¨ `SubAsker` ç­‰ç‰¹æ€§è½»æ¾å®ç°å±‚æ¬¡åˆ†æ˜çš„å‘½ä»¤è¡Œäº¤äº’è®¾è®¡ã€‚å¦‚æœæ‚¨å¯¹è¿™ä¸ªåº“çš„åŠŸèƒ½æ„Ÿåˆ°å…´å¥‹ï¼Œå¹¶å¸Œæœ›åœ¨æ‚¨çš„é¡¹ç›®ä¸­å°è¯•è¿™äº›åˆ›æ–°åŠŸèƒ½ï¼Œè¯·ç«‹å³å‰å¾€æˆ‘ä»¬çš„ GitHub ä»“åº“åœ°å€ï¼š

ğŸ‘‰ **GitHub é¡¹ç›®ä¸»é¡µ**ï¼šhttps://github.com/yexiyue/dialogue-macro

åœ¨æ­¤ï¼Œè¯šæŒšé‚€è¯·æ‚¨å…³æ³¨æˆ‘çš„é¡¹ç›®ã€å°è¯•ä½¿ç”¨æ–°ç‰ˆ dialoguer-macroï¼Œå¹¶å‚ä¸åˆ°é¡¹ç›®çš„æˆé•¿ä¸­æ¥ã€‚åªéœ€ç‚¹å‡»ä»“åº“é¡µé¢ä¸Šçš„ "Star" æŒ‰é’®ï¼Œå³å¯ç»™äºˆæˆ‘å®è´µçš„è‚¯å®šä¸æ”¯æŒã€‚åŒæ—¶ï¼Œæˆ‘ä¹Ÿçƒ­åˆ‡æœŸå¾…æ‚¨çš„åé¦ˆã€è´¡çŒ®ä»¥åŠå®é™…åº”ç”¨æ¡ˆä¾‹åˆ†äº«ï¼
